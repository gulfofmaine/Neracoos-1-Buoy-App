<!--
  Generated template for the BuoydataMapPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->

<ion-header>
  <ion-navbar primary>
    <button ion-button menuToggle="left" start>
      <ion-icon name="menu"></ion-icon>
    </button>
    <ion-title>Buoy Map</ion-title>
    <button ion-button menuToggle="right" end>
      <ion-icon name="menu"></ion-icon>
    </button>
  </ion-navbar>
</ion-header>


<ion-menu id='buoy_menu' [content]="buoy_menu_content" side="right">
  <ion-header>
    <ion-toolbar>
      <ion-title>Options</ion-title>
    </ion-toolbar>
  </ion-header>

  <ion-content>
  <ion-list>
   <ion-item class="listtitle">Toggle Stations on/off</ion-item>
    <ion-item *ngFor="let layer of labeled_options_display">
      <ion-label> {{layer.displayName}}   </ion-label>
      <ion-toggle [checked]="layer.visibility" (ionChange)="updateVisibility(layer)"></ion-toggle>
    </ion-item>

    <ion-item class="listtitle">WMS Layers</ion-item>
    <ion-item *ngFor="let layer of wms_options_display">
      <ion-label>{{layer.displayName}}</ion-label>
      <ion-toggle [checked]="layer.visibility" (ionChange)="updateVisibility(layer)"></ion-toggle>
      <ion-range min="0" max="100" step="5" [(ngModel)]="layer.opacity"
                    (ionChange)="updateOpacity(layer)"></ion-range>
    </ion-item>

    <ion-item class="listtitle">Select Base Layer</ion-item>
    <ion-item *ngFor="let layer of base_options_display">
      <ion-label>{{layer.displayName}}</ion-label>
      <ion-toggle [checked]="layer.visibility" (ionChange)="updateVisibility(layer)"></ion-toggle>
      <ion-range min="0" max="100" step="5" [(ngModel)]="layer.opacity"
                    (ionChange)="updateOpacity(layer)"></ion-range>

    </ion-item>
  </ion-list>
  </ion-content>
</ion-menu>

<ion-content padding>
<ion-grid>
  <ion-row>
    <ion-col col-12 col-sm-8>

  <div id="map" #map class="map"  data-tap-disabled="true">
    
  </div>
  <strong>Beach Erosion and Flooding Forecast</strong> <br />
  The impact markers for the beach locations will update based on the forecast. Click the marker to view the forecast.<p></p>
  <strong>Observation Stations </strong><br />
  Click a buoy to view the sensor observations and model forecast data. <p></p>
  Click a tide gauge station to view the tide observations and water level forecast data.
    </ion-col>
    <ion-col col-12 col-sm-4>
        <div id="popup">
            <div *ngIf="selectedFeature != undefined &&
                          selectedFeature.get('projectidentifier') != undefined">
              <div [ngSwitch]="selectedFeature.get('projectidentifier')">
                <div *ngSwitchCase="'INUNDATION'">
                  {{selectedFeature.get('monitoringlocationname')}}<br/>
                  {{selectedFeature.get('monitoringlocationdescriptiontext')}}
                </div>
              </div>
            </div>
            <!-- NERACOOS buoy data -->
            <!--http://www.neracoos.org/data/json/monitoringlocations.php?format=erddapgeojson -->
            <div *ngIf="selectedFeature != undefined &&
                          selectedFeature.get('mooring_site_desc') != undefined">
      
                <div [ngSwitch]="selectedFeature.get('project')">
                  <div *ngSwitchCase="'NERACOOS'">
                    {{selectedFeature.get('name')}}<br/>
                    Program: {{selectedFeature.get('program')}}<br/>
                    {{selectedFeature.get('mooring_site_desc')}}<br/>
                    <!--><span [innerHtml]="selectedFeature.get('platform_credit')"></span>-->
                  </div>
                  <div *ngSwitchCase="'LOBO NERACOOS'">
                    {{selectedFeature.get('name')}}<br/>
                    Project: {{selectedFeature.get('project')}}<br/>
                    {{selectedFeature.get('mooring_site_desc')}}<br/>
                    <!--><span [innerHtml]="selectedFeature.get('platform_credit')"></span>-->
                  </div>
                </div>
            </div>
            <!-- NOAA NOS/CO-OPS tide data -->
            <div *ngIf="selectedFeature != undefined &&
                          selectedFeature.get('projectidentifier') != undefined &&
                          selectedFeature.get('projectidentifier') == 'NOS/CO-OPS' &&
                          isNOAATideStation(selectedFeature.get('monitoringlocationidentifier'))">
                {{selectedFeature.get('monitoringlocationdescriptiontext')}}<br/>
                {{selectedFeature.get('monitoringlocationname')}}<br/>
                Station Id - {{selectedFeature.get('monitoringlocationidentifier')}}
                <span [innerHtml]="selectedFeature.get('platform_credit')"></span>
            </div>
            <div *ngIf="selectedFeature != undefined &&
                          selectedFeature.get('projectidentifier') != undefined &&
                          selectedFeature.get('projectidentifier') == 'NOS/CO-OPS' &&
                          !isNOAATideStation(selectedFeature.get('monitoringlocationidentifier'))">
                {{selectedFeature.get('monitoringlocationname')}}
            </div>
          </div>
        <ion-row>
          <ion-col>
          <h5>Legend</h5>
          </ion-col>
        </ion-row>
        <ion-row class="background">

        <ion-col><h6>Buoys and Tide Gauge Platforms</h6>NERACOOS Buoys <img src="{{icon_path}}/img/symbols/symbol_neracoos.png" width="15px" height="15px"><br />
NOAA Buoys <img src="{{icon_path}}/img/symbols/symbol_noaa.png" width="15px" height="15px"><br />
Water Level Stations <img src="{{icon_path}}/img/symbols/symbol_tide.gif" width="15px" height="15px">
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-list>
         <ion-item class="listtitle">WMS Legends</ion-item>
          <ng-container *ngFor="let layer of wms_legends">
            <ion-item *ngIf="layer.useTextLegendTitle && layer.visibility">
              {{layer.displayName}}
              <img src="{{layer.URL}}"/>
            </ion-item>
            <ion-item *ngIf="!layer.useTextLegendTitle && layer.visibility">
              <img src="{{layer.URL}}"/>
            </ion-item>
          </ng-container>
        </ion-list>
      </ion-row>

    </ion-col>
  </ion-row>
</ion-grid>


</ion-content>

<ion-nav [root]="BuoydataMapPage" #buoy_menu_content #page_menu swipeBackEnabled="false" ></ion-nav>
